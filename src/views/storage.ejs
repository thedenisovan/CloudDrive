<!DOCTYPE html>
<html lang="en">
  <%- include('./partials/shared', {page: 'Storage Page'}) %>
  <body id="storage-page">
    <%- include('./partials/header', {page: 'Storage Page'}) %>
    <div style="display: flex; flex: 1;">
      <%- include('./partials/sideBar') %>
      <section style="display: flex; flex-direction: column; flex: 1">
        <header id="storage-header">
          <form id="select-form" action="/storage" method="get">
            <select name="folders" onchange="this.form.submit()">
            <% folders.forEach((folder, idx) => { %>
                <option value="<%= folder.name %>"
                    <%= folder.name === (selectedFolder || folders[0].name) ? 'selected' : '' %>>
                    <%= folder.name %>
                </option>
            <% }) %>
            </select>
          </form>
          <% if (selectedFolder !== 'All Files' && selectedFolder !== 'Documents' && selectedFolder !== 'Other' && selectedFolder !== 'Gif' && selectedFolder !== 'Images') { %>
            <form action="/storage" method="post">
              <input type="hidden" name="action" value="delete" />
              <input type="hidden" name="selectedFolder" value="<%= selectedFolder %>" />
              <button style="background-color: #ffe0e0;" id="del-folder"><img src="/assets/del.svg" alt="create new folder" aria-label="create new folder"></button>
            </form>
            <h1>
            </h1>
          <% } %>
          <button id="new-folder"><img src="/assets/add.svg" alt="create new folder" aria-label="create new folder"></button>
          <div id="view-container">
            <button id="grid" class="grid active"><img  src="/assets/grid.svg" ></button>
            <button class="list inactive"><img src="/assets/list.svg" ></button>
          </div>
          <a href="/upload"><button id="upload-btn" style="display: flex; align-items: center;"><img src="/assets/upload-1.svg" aria-hidden="true" width="25"><p style="font-size: 1.1rem;">Upload</p></button></a>
        </header>
        <%- include('./partials/new-folder-form.ejs') %>
        <main id="main-main">
          <h2>
          <%= (selectedFolder) %>
          </h2>
          <% if (files.length === 0) {} else if (files.length === 1) { %>
          <p>
            <%= files.length %>
            file
          </p>
          <% } else { %>
            <p>
            <%= files.length %>
            files
          </p>
          <% } %>
          <div class="file-container">
          <% files.forEach(file => { %>
            <div class="file-div">
              <!-- checks what extension file have and adds correct svg to it -->
              <header class="file-header">
                <%- include('./partials/fileSvg', {ext: file.name.split('.')[file.name.split('.').length - 1]}) %>
                <h6>
                  <%= file.name %>
                </h6>
              </header>
              <div class="file-footer">
                <p>
                  <%= Number.parseFloat(file.size / 1000000).toFixed(2) %>
                  MB
                </p>
                <p>
                  <%= new Date(file.createdAt).getDate() %>
                  / <%= new Date(file.createdAt).getMonth() + 1 %>
                  / <%= new Date(file.createdAt).getFullYear() %>
                </p>
              </div>
            </div>
          <% }); %>
          </div>
        </main>
      </section>
    </div>
    <%- include('./partials/footer') %>
  </body>
  <%- include('./partials/scripts/storageDom') %>
</html>
